{% extends 'base.html' %}
{% load static %}

{% block title %}ReWear - Add Product{% endblock %}

{% block extra_css %}
<style>
/* Product page specific styles */
.product-page {
  background: url('../images/rewear_bg.png') center center/cover no-repeat;
  min-height: 100vh;
  position: relative;
  overflow-y: auto;
}

/* Override global body overflow from style.css */
body {
  overflow: auto !important;
}

.product-page::after {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    270deg,
    rgba(157, 78, 221, 0.4),
    rgba(255, 209, 253, 0.4),
    rgba(200, 191, 255, 0.4)
  );
  background-size: 600% 600%;
  animation: gradientFlow 20s ease infinite;
  z-index: 0;
  pointer-events: none;
}

.navbar {
  background: rgba(157, 78, 221, 0.9);
  backdrop-filter: blur(10px);
  padding: 15px 20px;
  position: relative;
  z-index: 10;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.navbar .logo {
  font-family: 'Titan One', cursive;
  font-size: 2rem;
  color: white;
  text-decoration: none;
}

.navbar .nav-links {
  display: flex;
  gap: 20px;
}

.navbar .nav-links a {
  color: white;
  text-decoration: none;
  padding: 8px 15px;
  border-radius: 20px;
  transition: background 0.3s ease;
}

.navbar .nav-links a:hover {
  background: rgba(255, 255, 255, 0.2);
}

.search-section {
  padding: 20px;
  position: relative;
  z-index: 5;
}

.search-bar {
  width: 100%;
  max-width: 800px;
  margin: 0 auto;
  display: flex;
  position: relative;
}

.search-bar input {
  width: 100%;
  padding: 15px 50px 15px 20px;
  border: none;
  border-radius: 25px;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  font-size: 16px;
  outline: none;
}

.search-bar button {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: #9d4edd;
  border: none;
  border-radius: 50%;
  width: 35px;
  height: 35px;
  cursor: pointer;
  color: white;
}

.product-content {
  padding: 20px;
  position: relative;
  z-index: 5;
  min-height: calc(100vh - 140px);
}

.product-main {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  margin-bottom: 30px;
  max-width: 1200px;
  margin: 0 auto 30px auto;
}

.image-section, .description-section {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(15px);
  border-radius: 15px;
  padding: 25px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  overflow: hidden;
}

.image-display-area {
  min-height: 400px;
  border: 2px solid #9d4edd;
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  color: #666;
  background: rgba(157, 78, 221, 0.05);
  padding: 20px;
  overflow: hidden;
}

.image-display-area img {
  max-width: 100%;
  max-height: 350px;
  object-fit: contain;
  border-radius: 10px;
  display: block;
}

.main-product-image {
  width: 100%;
  max-height: 350px;
  object-fit: cover;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.image-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 10px;
  margin-top: 15px;
}

.image-preview {
  width: 100%;
  height: 100px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.image-preview:hover {
  transform: scale(1.05);
  border: 2px solid #9d4edd;
  box-shadow: 0 4px 15px rgba(157, 78, 221, 0.3);
}

.description-area {
  width: 100%;
  min-height: 300px;
  border: 1px solid #ddd;
  border-radius: 10px;
  padding: 15px;
  font-size: 16px;
  background: rgba(255, 255, 255, 0.8);
  resize: none;
  cursor: default;
  box-sizing: border-box;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
}

.status-section {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 15px;
}

.status-indicator {
  padding: 8px 15px;
  border-radius: 20px;
  font-weight: bold;
  font-size: 14px;
}

.status-available {
  background: #28a745;
  color: white;
}

.status-unavailable {
  background: #dc3545;
  color: white;
}

.swap-button {
  background: #9d4edd;
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.swap-button:hover:not(:disabled) {
  background: #7b2cbf;
  transform: translateY(-2px);
}

.swap-button:disabled {
  background: #ccc;
  cursor: not-allowed;
  opacity: 0.6;
}

.previous-listings {
  max-width: 1200px;
  margin: 0 auto;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(15px);
  border-radius: 15px;
  padding: 25px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.listings-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.listing-card {
  background: rgba(255, 255, 255, 0.8);
  border-radius: 10px;
  padding: 15px;
  text-align: center;
  border: 1px solid #eee;
  transition: transform 0.3s ease;
}

.listing-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 20px rgba(157, 78, 221, 0.3);
}

.listing-image {
  width: 100%;
  height: 150px;
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 10px;
}

.listing-info {
  font-size: 14px;
  color: #333;
  margin-top: 5px;
}

@media (max-width: 768px) {
  .product-main {
    grid-template-columns: 1fr;
  }
  
  .listings-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .navbar {
    flex-direction: column;
    gap: 10px;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="product-page">
  <!-- Navigation Bar -->
  <nav class="navbar">
    <a href="/" class="logo">ReWear</a>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="/product/">My Products</a>
      <a href="/create/">Add Product</a>
      <a href="/user/">Profile</a>
      <a href="/login/">Login</a>
    </div>
  </nav>

  <!-- Search Bar -->
  <div class="search-section">
    <div class="search-bar">
      <input type="text" placeholder="Search for products, brands, or categories...">
      <button type="submit">üîç</button>
    </div>
  </div>

  <!-- Main Product Content -->
  <div class="product-content">
    <div class="product-main">
      <!-- Image Section -->
      <div class="image-section">
        <h3>Product Images</h3>
        <div class="image-display-area">
          <div>
            <img src="https://muselot.in/cdn/shop/products/Unisex--Plain--Golden-Yellow--hoodies-Muselot_6d8a2a23-85d5-468b-9c12-31f3a556300b.jpg?v=1638652618" alt="Golden Hoodie View 1">
          </div>
        </div>
        <div class="image-grid" id="imageGrid">
          <!-- Same image multiple times for preview -->
          <img src="https://muselot.in/cdn/shop/products/Unisex--Plain--Golden-Yellow--hoodies-Muselot_6d8a2a23-85d5-468b-9c12-31f3a556300b.jpg?v=1638652618" class="image-preview" alt="Golden Hoodie View 1">
          <img src="https://muselot.in/cdn/shop/products/Unisex--Plain--Golden-Yellow--hoodies-Muselot_6d8a2a23-85d5-468b-9c12-31f3a556300b.jpg?v=1638652618" class="image-preview" alt="Golden Hoodie View 2">
          <img src="https://muselot.in/cdn/shop/products/Unisex--Plain--Golden-Yellow--hoodies-Muselot_6d8a2a23-85d5-468b-9c12-31f3a556300b.jpg?v=1638652618" class="image-preview" alt="Golden Hoodie View 3">
          <img src="https://images.bewakoof.com/original/men-s-grey-hoodies-596540-1737712249-1.jpg" class="image-preview" alt="Golden Hoodie View 4">
        </div>
      </div>

      <!-- Description Section -->
      <div class="description-section">
        <h3>Product Description</h3>
        <textarea class="description-area" readonly>Product Title: Vintage Oversized Hoodie

Brand: Comfortable Wear
Size: Medium (fits like Large)
Condition: Excellent - worn only a few times
Color: Golden Yellow

Description:
This vintage-style oversized hoodie is perfect for casual wear. Made from soft cotton blend material that's incredibly comfortable and warm. The relaxed fit makes it ideal for layering or wearing on its own.

Features:
‚Ä¢ Soft cotton-polyester blend
‚Ä¢ Drawstring hood
‚Ä¢ Front kangaroo pocket
‚Ä¢ Ribbed cuffs and hem
‚Ä¢ Machine washable

Reason for selling: Cleaning out closet, no longer fits my style

Available for:
‚úÖ Swap with similar size hoodie/sweater
‚úÖ Direct sale

Price: ‚Çπ800 (originally ‚Çπ2000)

Pick up location: Available
Shipping: Available (buyer pays shipping)

Contact for more details or to arrange viewing!</textarea>
        <div class="status-section">
          <span class="status-indicator status-available">Available</span>
          <button class="swap-button" onclick="handleSwap()">Swap</button>
        </div>
      </div>
    </div>

    <!-- Previous Listings -->
    <div class="previous-listings">
      <h3>Previous Listings:</h3>
      <div class="listings-grid">
        <div class="listing-card">
          <img src="https://www.staycoldapparel.com/cdn/shop/files/VeilofThornsHoodie_40.jpg?v=1731336976&width=750" class="listing-image" alt="Black Hoodie">
          <p class="listing-info">Black Gothic Hoodie - Swapped</p>
        </div>
        <div class="listing-card">
          <img src="https://assets.myntassets.com/dpr_1.5,q_60,w_400,c_limit,fl_progressive/assets/images/2024/OCTOBER/22/eO61OfXe_c4061711b0be4ed3bc2cc5793c196858.jpg" class="listing-image" alt="Blue Hoodie">
          <p class="listing-info">Blue Casual Hoodie - Swapped</p>
        </div>
        <div class="listing-card">
          <img src="https://thebanyantee.com/cdn/shop/files/Baby-Pink_34d822c7-208a-4c95-adaa-bd56216b5fd2.jpg?v=1712927946" class="listing-image" alt="Pink Hoodie">
          <p class="listing-info">Baby Pink Hoodie - Available</p>
        </div>
        <div class="listing-card">
          <img src="https://cdn.media.amplience.net/i/mrpricegroup/01_105799818_SI_00?$preset$&w=320" class="listing-image" alt="White Hoodie">
          <p class="listing-info">White Basic Hoodie - Swapped</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Handle swap functionality
function handleSwap() {
    const statusIndicator = document.querySelector('.status-indicator');
    const swapButton = document.querySelector('.swap-button');
    
    if (statusIndicator.classList.contains('status-available')) {
        // Show swap dialog/modal
        if (confirm('Are you sure you want to initiate a swap for this item?')) {
            alert('Swap request initiated! You will be contacted by the owner.');
        }
    } else {
        alert('This item is currently unavailable for swap.');
    }
}

// Image preview click functionality
document.addEventListener('click', function(e) {
    // Handle image preview clicks to update main display
    if (e.target.classList.contains('image-preview')) {
        const mainImageContainer = document.querySelector('.image-display-area img');
        if (mainImageContainer) {
            mainImageContainer.src = e.target.src;
            mainImageContainer.alt = e.target.alt;
        }
        return; // Don't open modal for preview clicks
    }
    
    // Handle main image and listing image clicks to view larger
    if (e.target.classList.contains('main-product-image') || e.target.classList.contains('listing-image') || 
        (e.target.parentElement && e.target.parentElement.classList.contains('image-display-area'))) {
        // Create modal for enlarged view
        const modal = document.createElement('div');
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.backgroundColor = 'rgba(0,0,0,0.8)';
        modal.style.display = 'flex';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '1000';
        modal.style.cursor = 'pointer';
        
        const img = document.createElement('img');
        img.src = e.target.src;
        img.style.maxWidth = '90%';
        img.style.maxHeight = '90%';
        img.style.objectFit = 'contain';
        img.style.borderRadius = '10px';
        
        modal.appendChild(img);
        document.body.appendChild(modal);
        
        modal.onclick = function() {
            document.body.removeChild(modal);
        };
    }
});

// Example function to change availability status
function toggleAvailability() {
    const statusIndicator = document.querySelector('.status-indicator');
    const swapButton = document.querySelector('.swap-button');
    
    if (statusIndicator.classList.contains('status-available')) {
        statusIndicator.classList.remove('status-available');
        statusIndicator.classList.add('status-unavailable');
        statusIndicator.textContent = 'Unavailable';
        swapButton.disabled = true;
    } else {
        statusIndicator.classList.remove('status-unavailable');
        statusIndicator.classList.add('status-available');
        statusIndicator.textContent = 'Available';
        swapButton.disabled = false;
    }
}
</script>
{% endblock %}
